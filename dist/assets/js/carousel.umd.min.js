((t,e)=>{"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).window=t.window||{})})(this,function(t){function u(t,e=void 0){return!(!t||t===document.body||e&&t===e)&&((t=>{var e,i;if(t&&t instanceof Element&&t.offsetParent)return e=t.scrollHeight>t.clientHeight,i=-1!==(t=window.getComputedStyle(t).overflowY).indexOf("hidden"),t=-1!==t.indexOf("visible"),e&&!i&&!t})(t)?t:u(t.parentElement,e))}function l(t){var e=(new DOMParser).parseFromString(t,"text/html").body;if(1<e.childElementCount){for(var i=document.createElement("div");e.firstChild;)i.appendChild(e.firstChild);return i}return e.firstChild}let P=(t,e=1e4)=>(t=parseFloat(t+"")||0,Math.round((t+Number.EPSILON)*e)/e),s=t=>(""+(t||"")).split(" ").filter(t=>!!t),p=(e,t,i)=>{e&&s(t).forEach(t=>{e.classList.toggle(t,i||!1)})};class n{constructor(t){Object.defineProperty(this,"pageX",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"pageY",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"clientX",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"clientY",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"time",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"nativePointer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.nativePointer=t,this.pageX=t.pageX,this.pageY=t.pageY,this.clientX=t.clientX,this.clientY=t.clientY,this.id=self.Touch&&t instanceof Touch?t.identifier:-1,this.time=Date.now()}}let a={passive:!1};class F{constructor(t,{start:e=()=>!0,move:i=()=>{},end:s=()=>{}}){Object.defineProperty(this,"element",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"startCallback",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"moveCallback",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"endCallback",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"currentPointers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"startPointers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),this.element=t,this.startCallback=e,this.moveCallback=i,this.endCallback=s;for(let t of["onPointerStart","onTouchStart","onMove","onTouchEnd","onPointerEnd","onWindowBlur"])this[t]=this[t].bind(this);this.element.addEventListener("mousedown",this.onPointerStart,a),this.element.addEventListener("touchstart",this.onTouchStart,a),this.element.addEventListener("touchmove",this.onMove,a),this.element.addEventListener("touchend",this.onTouchEnd),this.element.addEventListener("touchcancel",this.onTouchEnd)}onPointerStart(t){if(t.buttons&&0===t.button){let e=new n(t);this.currentPointers.some(t=>t.id===e.id)||this.triggerPointerStart(e,t)&&(window.addEventListener("mousemove",this.onMove),window.addEventListener("mouseup",this.onPointerEnd),window.addEventListener("blur",this.onWindowBlur))}}onTouchStart(t){for(var e of Array.from(t.changedTouches||[]))this.triggerPointerStart(new n(e),t);window.addEventListener("blur",this.onWindowBlur)}onMove(t){let e=this.currentPointers.slice(),i="changedTouches"in t?Array.from(t.changedTouches||[]).map(t=>new n(t)):[new n(t)],s=[];for(let e of i){let t=this.currentPointers.findIndex(t=>t.id===e.id);t<0||(s.push(e),this.currentPointers[t]=e)}s.length&&this.moveCallback(t,this.currentPointers.slice(),e)}onPointerEnd(t){0<t.buttons&&0!==t.button||(this.triggerPointerEnd(t,new n(t)),window.removeEventListener("mousemove",this.onMove),window.removeEventListener("mouseup",this.onPointerEnd),window.removeEventListener("blur",this.onWindowBlur))}onTouchEnd(t){for(var e of Array.from(t.changedTouches||[]))this.triggerPointerEnd(t,new n(e))}triggerPointerStart(t,e){return!!this.startCallback(e,t,this.currentPointers.slice())&&(this.currentPointers.push(t),this.startPointers.push(t),!0)}triggerPointerEnd(t,e){var i=this.currentPointers.findIndex(t=>t.id===e.id);i<0||(this.currentPointers.splice(i,1),this.startPointers.splice(i,1),this.endCallback(t,e,this.currentPointers.slice()))}onWindowBlur(){this.clear()}clear(){for(;this.currentPointers.length;){var t=this.currentPointers[this.currentPointers.length-1];this.currentPointers.splice(this.currentPointers.length-1,1),this.startPointers.splice(this.currentPointers.length-1,1),this.endCallback(new Event("touchend",{bubbles:!0,cancelable:!0,clientX:t.clientX,clientY:t.clientY}),t,this.currentPointers.slice())}}stop(){this.element.removeEventListener("mousedown",this.onPointerStart,a),this.element.removeEventListener("touchstart",this.onTouchStart,a),this.element.removeEventListener("touchmove",this.onMove,a),this.element.removeEventListener("touchend",this.onTouchEnd),this.element.removeEventListener("touchcancel",this.onTouchEnd),window.removeEventListener("mousemove",this.onMove),window.removeEventListener("mouseup",this.onPointerEnd),window.removeEventListener("blur",this.onWindowBlur)}}function g(t,e){return e?Math.sqrt(Math.pow(e.clientX-t.clientX,2)+Math.pow(e.clientY-t.clientY,2)):0}function f(t,e){return e?{clientX:(t.clientX+e.clientX)/2,clientY:(t.clientY+e.clientY)/2}:t}function o(t,e){return t.split(".").reduce((t,e)=>"object"==typeof t?t[e]:void 0,e)}let r=t=>"object"==typeof t&&null!==t&&t.constructor===Object&&"[object Object]"===Object.prototype.toString.call(t),h=(s,...i)=>{let t=i.length;for(let e=0;e<t;e++){let t=i[e]||{};Object.entries(t).forEach(([t,e])=>{var i=Array.isArray(e)?[]:{};s[t]||Object.assign(s,{[t]:i}),r(e)?Object.assign(s[t],h(i,e)):Array.isArray(e)?Object.assign(s,{[t]:[...e]}):Object.assign(s,{[t]:e})})}return s};class e{constructor(t={}){Object.defineProperty(this,"options",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"events",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),this.setOptions(t);for(let t of Object.getOwnPropertyNames(Object.getPrototypeOf(this)))t.startsWith("on")&&"function"==typeof this[t]&&(this[t]=this[t].bind(this))}setOptions(t){this.options=t?h({},this.constructor.defaults,t):{};for(let[t,e]of Object.entries(this.option("on")||{}))this.on(t,e)}option(t,...e){let i=o(t,this.options);return i=i&&"function"==typeof i?i.call(this,this,...e):i}optionFor(t,e,i,...s){let n=o(e,t),a;(n="false"===(n="true"===(n="string"!=typeof(a=n)||isNaN(a)||isNaN(parseFloat(a))?n:parseFloat(n))?!0:n)?!1:n)&&"function"==typeof n&&(n=n.call(this,this,t,...s));e=o(e,this.options);return e&&"function"==typeof e?n=e.call(this,this,t,...s,n):void 0===n&&(n=e),void 0===n?i:n}cn(t){var e=this.options.classes;return e&&e[t]||""}localize(e,i=[]){e=String(e).replace(/\{\{(\w+).?(\w+)?\}\}/g,(t,e,i)=>{let s="";return i?s=this.option(e[0]+e.toLowerCase().substring(1)+".l10n."+i):e&&(s=this.option("l10n."+e)),s=s||t});for(let t=0;t<i.length;t++)e=e.split(i[t][0]).join(i[t][1]);return e.replace(/\{\{(.*?)\}\}/g,(t,e)=>e)}on(t,i){let e=[];"string"==typeof t?e=t.split(" "):Array.isArray(t)&&(e=t),this.events||(this.events=new Map),e.forEach(t=>{let e=this.events.get(t);e||(this.events.set(t,[]),e=[]),e.includes(i)||e.push(i),this.events.set(t,e)})}off(t,i){let e=[];"string"==typeof t?e=t.split(" "):Array.isArray(t)&&(e=t),e.forEach(t=>{var e=this.events.get(t);if(Array.isArray(e)){let t=e.indexOf(i);-1<t&&e.splice(t,1)}})}emit(t,...e){[...this.events.get(t)||[]].forEach(t=>t(this,...e)),"*"!==t&&this.emit("*",t,...e)}}Object.defineProperty(e,"version",{enumerable:!0,configurable:!0,writable:!0,value:"5.0.36"}),Object.defineProperty(e,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:{}});class i extends e{constructor(t={}){super(t),Object.defineProperty(this,"plugins",{enumerable:!0,configurable:!0,writable:!0,value:{}})}attachPlugins(t={}){var i,s,n=new Map;for([i,s]of Object.entries(t)){let t=this.option(i),e=this.plugins[i];e||!1===t?e&&!1===t&&(e.detach(),delete this.plugins[i]):n.set(i,new s(this,t||{}))}for(let[t,e]of n)this.plugins[t]=e,e.attach()}detachPlugins(t){for(var e of t=t||Object.keys(this.plugins)){let t=this.plugins[e];t&&t.detach(),delete this.plugins[e]}return this.emit("detachPlugins"),this}}var m,v,c;(c=m=m||{})[c.Init=0]="Init",c[c.Error=1]="Error",c[c.Ready=2]="Ready",c[c.Panning=3]="Panning",c[c.Mousemove=4]="Mousemove",c[c.Destroy=5]="Destroy";let b=["a","b","c","d","e","f"],I='<circle cx="25" cy="25" r="20"></circle>',B='<div class="f-spinner"><svg viewBox="0 0 50 50">'+I+I+"</svg></div>",d=t=>t&&null!==t&&t instanceof Element&&"nodeType"in t,y=(e,t)=>{e&&s(t).forEach(t=>{e.classList.remove(t)})},w=(e,t)=>{e&&s(t).forEach(t=>{e.classList.add(t)})},x={a:1,b:0,c:0,d:1,e:0,f:0},T=1e4,S="mousemove",H="drag",N="content",M="auto",O=null,E=null;class k extends i{get fits(){return this.contentRect.width-this.contentRect.fitWidth<1&&this.contentRect.height-this.contentRect.fitHeight<1}get isTouchDevice(){return E=null===E?window.matchMedia("(hover: none)").matches:E}get isMobile(){return O=null===O?/iPhone|iPad|iPod|Android/i.test(navigator.userAgent):O}get panMode(){return this.options.panMode!==S||this.isTouchDevice?H:S}get panOnlyZoomed(){var t=this.options.panOnlyZoomed;return t===M?this.isTouchDevice:t}get isInfinite(){return this.option("infinite")}get angle(){return 180*Math.atan2(this.current.b,this.current.a)/Math.PI||0}get targetAngle(){return 180*Math.atan2(this.target.b,this.target.a)/Math.PI||0}get scale(){var{a:t,b:e}=this.current;return Math.sqrt(t*t+e*e)||1}get targetScale(){var{a:t,b:e}=this.target;return Math.sqrt(t*t+e*e)||1}get minScale(){return this.option("minScale")||1}get fullScale(){var t=this.contentRect;return t.fullWidth/t.fitWidth||1}get maxScale(){return this.fullScale*(this.option("maxScale")||1)||1}get coverScale(){var{containerRect:t,contentRect:e}=this,t=Math.max(t.height/e.fitHeight,t.width/e.fitWidth)||1;return Math.min(this.fullScale,t)}get isScaling(){return 1e-5<Math.abs(this.targetScale-this.scale)&&!this.isResting}get isContentLoading(){var t=this.content;return!!(t&&t instanceof HTMLImageElement)&&!t.complete}get isResting(){if(this.isBouncingX||this.isBouncingY)return!1;for(var t of b){var e="e"==t||"f"===t?1e-4:1e-5;if(Math.abs(this.target[t]-this.current[t])>e)return!1}return!(!this.ignoreBounds&&!this.checkBounds().inBounds)}constructor(e,t={},i={}){if(super(t),Object.defineProperty(this,"pointerTracker",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"resizeObserver",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"updateTimer",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"clickTimer",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"rAF",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"isTicking",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreBounds",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"isBouncingX",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"isBouncingY",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"clicks",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"trackingPoints",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"pwt",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"cwd",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"pmme",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"friction",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:m.Init}),Object.defineProperty(this,"isDragging",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"container",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"content",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"spinner",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"containerRect",{enumerable:!0,configurable:!0,writable:!0,value:{width:0,height:0,innerWidth:0,innerHeight:0}}),Object.defineProperty(this,"contentRect",{enumerable:!0,configurable:!0,writable:!0,value:{top:0,right:0,bottom:0,left:0,fullWidth:0,fullHeight:0,fitWidth:0,fitHeight:0,width:0,height:0}}),Object.defineProperty(this,"dragStart",{enumerable:!0,configurable:!0,writable:!0,value:{x:0,y:0,top:0,left:0,time:0}}),Object.defineProperty(this,"dragOffset",{enumerable:!0,configurable:!0,writable:!0,value:{x:0,y:0,time:0}}),Object.defineProperty(this,"current",{enumerable:!0,configurable:!0,writable:!0,value:Object.assign({},x)}),Object.defineProperty(this,"target",{enumerable:!0,configurable:!0,writable:!0,value:Object.assign({},x)}),Object.defineProperty(this,"velocity",{enumerable:!0,configurable:!0,writable:!0,value:{a:0,b:0,c:0,d:0,e:0,f:0}}),Object.defineProperty(this,"lockedAxis",{enumerable:!0,configurable:!0,writable:!0,value:!1}),!e)throw new Error("Container Element Not Found");this.container=e,this.initContent(),this.attachPlugins(Object.assign(Object.assign({},k.Plugins),i)),this.emit("attachPlugins"),this.emit("init");i=this.content;if(i.addEventListener("load",this.onLoad),i.addEventListener("error",this.onError),this.isContentLoading){if(this.option("spinner")){e.classList.add(this.cn("isLoading"));let t=l(B);!e.contains(i)||i.parentElement instanceof HTMLPictureElement?this.spinner=e.appendChild(t):this.spinner=(null==(e=i.parentElement)?void 0:e.insertBefore(t,i))||null}this.emit("beforeLoad")}else queueMicrotask(()=>{this.enable()})}initContent(){var t=this.container,e=this.cn(N);let i=this.option(N)||t.querySelector("."+e);if(i||(i=t.querySelector("img,picture")||t.firstElementChild)&&w(i,e),!(i=i instanceof HTMLPictureElement?i.querySelector("img"):i))throw new Error("No content found");this.content=i}onLoad(){var{spinner:t,container:e,state:i}=this;t&&(t.remove(),this.spinner=null),this.option("spinner")&&e.classList.remove(this.cn("isLoading")),this.emit("afterLoad"),i===m.Init?this.enable():this.updateMetrics()}onError(){this.state!==m.Destroy&&(this.spinner&&(this.spinner.remove(),this.spinner=null),this.stop(),this.detachEvents(),this.state=m.Error,this.emit("error"))}getNextScale(t){let{fullScale:e,targetScale:i,coverScale:s,maxScale:n,minScale:a}=this,o=a;switch(t){case"toggleMax":o=i-a<.5*(n-a)?n:a;break;case"toggleCover":o=i-a<.5*(s-a)?s:a;break;case"toggleZoom":o=i-a<.5*(e-a)?e:a;break;case"iterateZoom":var r=[1,e,n].sort((t,e)=>t-e),l=r.findIndex(t=>t>i+1e-5);o=r[l]||1}return o}attachObserver(){let t,e=()=>{var{container:t,containerRect:e}=this;return.1<Math.abs(e.width-t.getBoundingClientRect().width)||.1<Math.abs(e.height-t.getBoundingClientRect().height)};this.resizeObserver||void 0===window.ResizeObserver||(this.resizeObserver=new ResizeObserver(()=>{this.updateTimer||(e()?(this.onResize(),this.isMobile&&(this.updateTimer=setTimeout(()=>{e()&&this.onResize(),this.updateTimer=null},500))):this.updateTimer&&(clearTimeout(this.updateTimer),this.updateTimer=null))})),null!=(t=this.resizeObserver)&&t.observe(this.container)}detachObserver(){var t;null!=(t=this.resizeObserver)&&t.disconnect()}attachEvents(){var t=this.container;t.addEventListener("click",this.onClick,{passive:!1,capture:!1}),t.addEventListener("wheel",this.onWheel,{passive:!1}),this.pointerTracker=new F(t,{start:this.onPointerDown,move:this.onPointerMove,end:this.onPointerUp}),document.addEventListener(S,this.onMouseMove)}detachEvents(){var t=this.container;t.removeEventListener("click",this.onClick,{passive:!1,capture:!1}),t.removeEventListener("wheel",this.onWheel,{passive:!1}),null!=(t=this.pointerTracker)&&t.stop(),this.pointerTracker=null,document.removeEventListener(S,this.onMouseMove),document.removeEventListener("keydown",this.onKeydown,!0),this.clickTimer&&(clearTimeout(this.clickTimer),this.clickTimer=null),this.updateTimer&&(clearTimeout(this.updateTimer),this.updateTimer=null)}animate(){this.setTargetForce();var t,e=this.friction,i=this.option("maxVelocity");for(t of b)e?(this.velocity[t]*=1-e,i&&!this.isScaling&&(this.velocity[t]=Math.max(Math.min(this.velocity[t],i),-1*i)),this.current[t]+=this.velocity[t]):this.current[t]=this.target[t];this.setTransform(),this.setEdgeForce(),!this.isResting||this.isDragging?this.rAF=requestAnimationFrame(()=>this.animate()):this.stop("current")}setTargetForce(){for(var t of b)"e"===t&&this.isBouncingX||"f"===t&&this.isBouncingY||(this.velocity[t]=(1/(1-this.friction)-1)*(this.target[t]-this.current[t]))}checkBounds(t=0,e=0){var i=this.current,t=i.e+t,i=i.f+e,e=this.getBounds(),{x:s,y:n}=e,a=s.min,s=s.max,o=n.min,n=n.max;let r=0,l=0;return a!==1/0&&t<a?r=a-t:s!==1/0&&s<t&&(r=s-t),o!==1/0&&i<o?l=o-i:n!==1/0&&n<i&&(l=n-i),Math.abs(r)<1e-4&&(r=0),Math.abs(l)<1e-4&&(l=0),Object.assign(Object.assign({},e),{xDiff:r,yDiff:l,inBounds:!r&&!l})}clampTargetBounds(){var t=this.target,{x:e,y:i}=this.getBounds();e.min!==1/0&&(t.e=Math.max(t.e,e.min)),e.max!==1/0&&(t.e=Math.min(t.e,e.max)),i.min!==1/0&&(t.f=Math.max(t.f,i.min)),i.max!==1/0&&(t.f=Math.min(t.f,i.max))}calculateContentDim(u=this.current){let{content:g,contentRect:t}=this,{fitWidth:p,fitHeight:f,fullWidth:m,fullHeight:v}=t,b=m,y=v;if(this.option("zoom")||0!==this.angle){let t=!(g instanceof HTMLImageElement||"none"!==window.getComputedStyle(g).maxWidth&&"none"!==window.getComputedStyle(g).maxHeight),e=t?m:p,i=t?v:f,s=this.getMatrix(u),n=new DOMPoint(0,0).matrixTransform(s),a=new DOMPoint(0+e,0).matrixTransform(s),o=new DOMPoint(0+e,0+i).matrixTransform(s),r=new DOMPoint(0,0+i).matrixTransform(s),l=Math.abs(o.x-n.x),h=Math.abs(o.y-n.y),c=Math.abs(r.x-a.x),d=Math.abs(r.y-a.y);b=Math.max(l,c),y=Math.max(h,d)}return{contentWidth:b,contentHeight:y}}setEdgeForce(){if(this.ignoreBounds||this.isDragging||this.panMode===S||this.targetScale<this.scale)this.isBouncingX=!1,this.isBouncingY=!1;else{var i=this.target,{x:s,y:n,xDiff:a,yDiff:o}=this.checkBounds(),r=this.option("maxVelocity");let t=this.velocity.e,e=this.velocity.f;0!==a?(this.isBouncingX=!0,a*t<=0?t+=.14*a:(t=.14*a,s.min!==1/0&&(this.target.e=Math.max(i.e,s.min)),s.max!==1/0&&(this.target.e=Math.min(i.e,s.max))),r&&(t=Math.max(Math.min(t,r),-1*r))):this.isBouncingX=!1,0!==o?(this.isBouncingY=!0,o*e<=0?e+=.14*o:(e=.14*o,n.min!==1/0&&(this.target.f=Math.max(i.f,n.min)),n.max!==1/0&&(this.target.f=Math.min(i.f,n.max))),r&&(e=Math.max(Math.min(e,r),-1*r))):this.isBouncingY=!1,this.isBouncingX&&(this.velocity.e=t),this.isBouncingY&&(this.velocity.f=e)}}enable(){let t=this.content,e=new DOMMatrixReadOnly(window.getComputedStyle(t).transform);for(let t of b)this.current[t]=this.target[t]=e[t];this.updateMetrics(),this.attachObserver(),this.attachEvents(),this.state=m.Ready,this.emit("ready")}onClick(s){"click"===s.type&&0===s.detail&&(this.dragOffset.x=0,this.dragOffset.y=0),this.isDragging&&(null!=(e=this.pointerTracker)&&e.clear(),this.trackingPoints=[],this.startDecelAnim());let t=s.target;if(t&&!s.defaultPrevented)if(t.hasAttribute("disabled"))s.preventDefault(),s.stopPropagation();else if(!(e=window.getSelection())||"Range"!==e.type||t.closest("button")){var e,i=t.closest("[data-panzoom-action]"),n=t.closest("[data-panzoom-change]"),i=i||n,n=i&&d(i)?i.dataset:null;if(n){let e=n.panzoomChange,t=n.panzoomAction;if((e||t)&&s.preventDefault(),e){let t={};try{t=JSON.parse(e)}catch(s){console&&console.warn("The given data was not valid JSON")}return void this.applyChange(t)}if(t)return void(this[t]&&this[t]())}if(3<Math.abs(this.dragOffset.x)||3<Math.abs(this.dragOffset.y))s.preventDefault(),s.stopPropagation();else if(!t.closest("[data-fancybox]")){i=this.content.getBoundingClientRect(),n=this.dragStart;if(!n.time||this.canZoomOut()||!(2<Math.abs(i.x-n.x)||2<Math.abs(i.y-n.y))){this.dragStart.time=0;let t=t=>{this.option("zoom",s)&&t&&"string"==typeof t&&/(iterateZoom)|(toggle(Zoom|Full|Cover|Max)|(zoomTo(Fit|Cover|Max)))/.test(t)&&"function"==typeof this[t]&&(s.preventDefault(),this[t]({event:s}))},e=this.option("click",s),i=this.option("dblClick",s);i?(this.clicks++,1==this.clicks&&(this.clickTimer=setTimeout(()=>{1===this.clicks?(this.emit("click",s),!s.defaultPrevented&&e&&t(e)):(this.emit("dblClick",s),s.defaultPrevented||t(i)),this.clicks=0,this.clickTimer=null},350))):(this.emit("click",s),!s.defaultPrevented&&e&&t(e))}}}}addTrackingPoint(t){var e=this.trackingPoints.filter(t=>t.time>Date.now()-100);e.push(t),this.trackingPoints=e}onPointerDown(t,e,i){if(!1===this.option("touch",t))return!1;this.pwt=0,this.dragOffset={x:0,y:0,time:0},this.trackingPoints=[];var s=this.content.getBoundingClientRect();if(this.dragStart={x:s.x,y:s.y,top:s.top,left:s.left,time:Date.now()},this.clickTimer)return!1;if(this.panMode===S&&1<this.targetScale)return t.preventDefault(),t.stopPropagation(),!1;s=t.composedPath()[0];if(!i.length){if(["TEXTAREA","OPTION","INPUT","SELECT","VIDEO","IFRAME"].includes(s.nodeName)||s.closest("[contenteditable],[data-selectable],[data-draggable],[data-clickable],[data-panzoom-change],[data-panzoom-action]"))return!1;null!=(i=window.getSelection())&&i.removeAllRanges()}if("mousedown"===t.type)["A","BUTTON"].includes(s.nodeName)||t.preventDefault();else if(.3<Math.abs(this.velocity.a))return!1;return this.target.e=this.current.e,this.target.f=this.current.f,this.stop(),this.isDragging||(this.isDragging=!0,this.addTrackingPoint(e),this.emit("touchStart",t)),!0}onPointerMove(o,r,l){if(!1!==this.option("touch",o)&&this.isDragging&&!(r.length<2&&this.panOnlyZoomed&&P(this.targetScale)<=P(this.minScale)||(this.emit("touchMove",o),o.defaultPrevented))){this.addTrackingPoint(r[0]);var h=this.content,c=f(l[0],l[1]),d=f(r[0],r[1]);let e=0,i=0;if(1<r.length){let t=h.getBoundingClientRect();e=c.clientX-t.left-.5*t.width,i=c.clientY-t.top-.5*t.height}var h=g(l[0],l[1]),l=g(r[0],r[1]);let t=h?l/h:1,s=d.clientX-c.clientX,n=d.clientY-c.clientY,a=(this.dragOffset.x+=s,this.dragOffset.y+=n,this.dragOffset.time=Date.now()-this.dragStart.time,P(this.targetScale)===P(this.minScale)&&this.option("lockAxis"));if(a&&!this.lockedAxis)if("xy"===a||"y"===a||"touchmove"===o.type){if(Math.abs(this.dragOffset.x)<6&&Math.abs(this.dragOffset.y)<6)return void o.preventDefault();let t=Math.abs(180*Math.atan2(this.dragOffset.y,this.dragOffset.x)/Math.PI);this.lockedAxis=45<t&&t<135?"y":"x",this.dragOffset.x=0,this.dragOffset.y=0,s=0,n=0}else this.lockedAxis=a;u(o.target,this.content)&&(a="x",this.dragOffset.y=0),a&&"xy"!==a&&this.lockedAxis!==a&&P(this.targetScale)===P(this.minScale)||(o.cancelable&&o.preventDefault(),this.container.classList.add(this.cn("isDragging")),r=this.checkBounds(s,n),this.option("rubberband")?("x"!==this.isInfinite&&(0<r.xDiff&&s<0||r.xDiff<0&&0<s)&&(s*=Math.max(0,.5-Math.abs(.75/this.contentRect.fitWidth*r.xDiff))),"y"!==this.isInfinite&&(0<r.yDiff&&n<0||r.yDiff<0&&0<n)&&(n*=Math.max(0,.5-Math.abs(.75/this.contentRect.fitHeight*r.yDiff)))):(r.xDiff&&(s=0),r.yDiff&&(n=0)),l=this.targetScale,h=this.minScale,d=this.maxScale,l<.5*h&&(t=Math.max(t,h)),1.5*d<l&&(t=Math.min(t,d)),"y"===this.lockedAxis&&P(l)===P(h)&&(s=0),"x"===this.lockedAxis&&P(l)===P(h)&&(n=0),this.applyChange({originX:e,originY:i,panX:s,panY:n,scale:t,friction:this.option("dragFriction"),ignoreBounds:!0}))}}onPointerUp(t,e,i){i.length?(this.dragOffset.x=0,this.dragOffset.y=0,this.trackingPoints=[]):(this.container.classList.remove(this.cn("isDragging")),this.isDragging&&(this.addTrackingPoint(e),this.panOnlyZoomed&&this.contentRect.width-this.contentRect.fitWidth<1&&this.contentRect.height-this.contentRect.fitHeight<1&&(this.trackingPoints=[]),u(t.target,this.content)&&"y"===this.lockedAxis&&(this.trackingPoints=[]),this.emit("touchEnd",t),this.isDragging=!1,this.lockedAxis=!1,this.state!==m.Destroy)&&!t.defaultPrevented&&this.startDecelAnim())}startDecelAnim(){var t=this.isScaling;this.rAF&&(cancelAnimationFrame(this.rAF),this.rAF=null),this.isBouncingX=!1,this.isBouncingY=!1;for(let t of b)this.velocity[t]=0;this.target.e=this.current.e,this.target.f=this.current.f,y(this.container,"is-scaling"),y(this.container,"is-animating"),this.isTicking=!1;var e=this.trackingPoints,i=e[0],e=e[e.length-1];let s=0,n=0,a=0;e&&i&&(s=e.clientX-i.clientX,n=e.clientY-i.clientY,a=e.time-i.time);e=(null==(d=window.visualViewport)?void 0:d.scale)||1;1!==e&&(s*=e,n*=e);let o=0,r=0,l=0,h=0,c=this.option("decelFriction");i=this.targetScale;if(0<a){l=3<Math.abs(s)?s/(a/30):0,h=3<Math.abs(n)?n/(a/30):0;let t=this.option("maxVelocity");t&&(l=Math.max(Math.min(l,t),-1*t),h=Math.max(Math.min(h,t),-1*t))}l&&(o=l/(1/(1-c)-1)),h&&(r=h/(1/(1-c)-1)),("y"===this.option("lockAxis")||"xy"===this.option("lockAxis")&&"y"===this.lockedAxis&&P(i)===this.minScale)&&(o=l=0),("x"===this.option("lockAxis")||"xy"===this.option("lockAxis")&&"x"===this.lockedAxis&&P(i)===this.minScale)&&(r=h=0);var d=this.dragOffset.x,e=this.dragOffset.y,u=this.option("dragMinThreshold")||0;Math.abs(d)<u&&Math.abs(e)<u&&(o=r=0,l=h=0),(this.option("zoom")&&(i<this.minScale-1e-5||i>this.maxScale+1e-5)||t&&!o&&!r)&&(c=.35),this.applyChange({panX:o,panY:r,friction:c}),this.emit("decel",l,h,d,e)}onWheel(t){var e=[-t.deltaX||0,-t.deltaY||0,-t.detail||0].reduce(function(t,e){return Math.abs(e)>Math.abs(t)?e:t}),e=Math.max(-1,Math.min(1,e));this.emit("wheel",t,e),this.panMode===S||t.defaultPrevented||("pan"===(e=this.option("wheel"))?(t.preventDefault(),this.panOnlyZoomed&&!this.canZoomOut()||this.applyChange({panX:2*-t.deltaX,panY:2*-t.deltaY,bounce:!1})):"zoom"===e&&!1!==this.option("zoom")&&this.zoomWithWheel(t))}onMouseMove(t){this.panWithMouse(t)}onKeydown(t){"Escape"===t.key&&this.toggleFS()}onResize(){this.updateMetrics(),this.checkBounds().inBounds||this.requestTick()}setTransform(){this.emit("beforeTransform");let{current:i,target:s,content:t,contentRect:e}=this,n=Object.assign({},x);for(let e of b){let t="e"==e||"f"===e?T:1e5;n[e]=P(i[e],t),Math.abs(s[e]-i[e])<("e"==e||"f"===e?.51:.001)&&(i[e]=s[e])}let{a,b:o,c:r,d:l,e:h,f:c}=n,d=`matrix(${a}, ${o}, ${r}, ${l}, ${h}, ${c})`,u=t.parentElement instanceof HTMLPictureElement?t.parentElement:t;var g,p;(u=this.option("transformParent")?u.parentElement||u:u).style.transform!==d&&(u.style.transform=d,{contentWidth:g,contentHeight:p}=this.calculateContentDim(),e.width=g,e.height=p,this.emit("afterTransform"))}updateMetrics(r=!1){if(this&&this.state!==m.Destroy&&!this.isContentLoading){var l=Math.max(1,(null==(l=window.visualViewport)?void 0:l.scale)||1),{container:h,content:c}=this,d=c instanceof HTMLImageElement,h=h.getBoundingClientRect(),u=getComputedStyle(this.container),g=h.width*l,p=h.height*l,f=parseFloat(u.paddingTop)+parseFloat(u.paddingBottom),u=g-(parseFloat(u.paddingLeft)+parseFloat(u.paddingRight)),u=(this.containerRect={width:g,height:p,innerWidth:u,innerHeight:p-f},parseFloat(c.dataset.width||"")||((g=c)instanceof HTMLImageElement?g.naturalWidth:g instanceof SVGElement?g.width.baseVal.value:Math.max(g.offsetWidth,g.scrollWidth))||0),f=parseFloat(c.dataset.height||"")||((p=c)instanceof HTMLImageElement?p.naturalHeight:p instanceof SVGElement?p.height.baseVal.value:Math.max(p.offsetHeight,p.scrollHeight))||0;let t=this.option("width",u)||M,e=this.option("height",f)||M;g=t===M,p=e===M;"number"!=typeof t&&(t=u),"number"!=typeof e&&(e=f),g&&(t=u*(e/f)),p&&(e=f/(u/t));let i=c.parentElement instanceof HTMLPictureElement?c.parentElement:c;g=(i=this.option("transformParent")?i.parentElement||i:i).getAttribute("style")||"",p=(i.style.setProperty("transform","none","important"),d&&(i.style.width="",i.style.height=""),i.offsetHeight,c.getBoundingClientRect());let s=p.width*l,n=p.height*l,a=s,o=n;s=Math.min(s,t),n=Math.min(n,e),d?{width:s,height:n}=((t,e,i,s)=>{i=Math.min(i/t,s/e);return{width:t*=i,height:e*=i}})(t,e,s,n):(s=Math.min(s,t),n=Math.min(n,e));f=.5*(o-n),u=.5*(a-s);this.contentRect=Object.assign(Object.assign({},this.contentRect),{top:p.top-h.top+f,bottom:h.bottom-p.bottom+f,left:p.left-h.left+u,right:h.right-p.right+u,fitWidth:s,fitHeight:n,width:s,height:n,fullWidth:t,fullHeight:e}),i.style.cssText=g,d&&(i.style.width=s+"px",i.style.height=n+"px"),this.setTransform(),!0!==r&&this.emit("refresh"),this.ignoreBounds||(P(this.targetScale)<P(this.minScale)?this.zoomTo(this.minScale,{friction:0}):this.targetScale>this.maxScale?this.zoomTo(this.maxScale,{friction:0}):this.state===m.Init||this.checkBounds().inBounds||this.requestTick()),this.updateControls()}}calculateBounds(){var{contentWidth:o,contentHeight:r}=this.calculateContentDim(this.target),{targetScale:l,lockedAxis:h}=this,{fitWidth:c,fitHeight:d}=this.contentRect;let u=0,g=0,p=0,f=0;var m=this.option("infinite");if(!0===m||h&&m===h)u=-1/0,p=1/0,g=-1/0,f=1/0;else{let{containerRect:t,contentRect:e}=this,i=P(c*l,T),s=P(d*l,T),{innerWidth:n,innerHeight:a}=t;t.width===i&&(n=t.width),t.width===s&&(a=t.height),o>n&&(p=.5*(o-n),u=-1*p,m=.5*(e.right-e.left),u+=m,p+=m),c>n&&o<n&&(u-=.5*(c-n),p-=.5*(c-n)),r>a&&(f=.5*(r-a),g=-1*f,h=.5*(e.bottom-e.top),g+=h,f+=h),d>a&&r<a&&(u-=.5*(d-a),p-=.5*(d-a))}return{x:{min:u,max:p},y:{min:g,max:f}}}getBounds(){var t=this.option("bounds");return t!==M?t:this.calculateBounds()}updateControls(){let t=this,e=t.container,{panMode:i,contentRect:s,targetScale:n,minScale:a}=t,o=a,r=t.option("click")||!1,l=(r&&(o=t.getNextScale(r)),t.canZoomIn()),h=t.canZoomOut(),c=i===H&&!!this.option("touch"),d=h&&c;if(c&&(P(n)<P(a)&&!this.panOnlyZoomed&&(d=!0),P(s.width,1)>P(s.fitWidth,1)||P(s.height,1)>P(s.fitHeight,1))&&(d=!0),P(s.width*n,1)<P(s.fitWidth,1)&&(d=!1),i===S&&(d=!1),p(e,this.cn("isDraggable"),d),this.option("zoom")){var u=l&&P(o)>P(n),g=!u&&!d&&h&&P(o)<P(n);p(e,this.cn("canZoomIn"),u),p(e,this.cn("canZoomOut"),g);for(let s of e.querySelectorAll("[data-panzoom-action]")){let e=!1,i=!1;switch(s.dataset.panzoomAction){case"zoomIn":l?e=!0:i=!0;break;case"zoomOut":h?e=!0:i=!0;break;case"toggleZoom":case"iterateZoom":l||h?e=!0:i=!0;let t=s.querySelector("g");t&&(t.style.display=l?"":"none")}e?(s.removeAttribute("disabled"),s.removeAttribute("tabindex")):i&&(s.setAttribute("disabled",""),s.setAttribute("tabindex","-1"))}}}panTo({x:t=this.target.e,y:e=this.target.f,scale:i=this.targetScale,friction:s=this.option("friction"),angle:n=0,originX:a=0,originY:o=0,flipX:r=!1,flipY:l=!1,ignoreBounds:h=!1}){this.state!==m.Destroy&&this.applyChange({panX:t-this.target.e,panY:e-this.target.f,scale:i/this.targetScale,angle:n,originX:a,originY:o,friction:s,flipX:r,flipY:l,ignoreBounds:h})}applyChange({panX:t=0,panY:i=0,scale:s=1,angle:n=0,originX:a=-this.current.e,originY:o=-this.current.f,friction:r=this.option("friction"),flipX:l=!1,flipY:h=!1,ignoreBounds:c=!1,bounce:d=this.option("bounce")}){var u=this.state;if(u!==m.Destroy){this.rAF&&(cancelAnimationFrame(this.rAF),this.rAF=null),this.friction=r||0,this.ignoreBounds=c;var r=this.current,g=r.e,r=r.f,p=this.getMatrix(this.target);let e=(new DOMMatrix).translate(g,r).translate(a,o).translate(t,i);if(this.option("zoom")){if(!c){let t=this.targetScale,e=this.minScale,i=this.maxScale;t*(s=t*s<e?e/t:s)>i&&(s=i/t)}e=e.scale(s)}e=e.translate(-a,-o).translate(-g,-r).multiply(p),n&&(e=e.rotate(n)),l&&(e=e.scale(-1,1)),h&&(e=e.scale(1,-1));for(let t of b)"e"!==t&&"f"!==t&&(e[t]>this.minScale+1e-5||e[t]<this.minScale-1e-5)?this.target[t]=e[t]:this.target[t]=P(e[t],T);(this.targetScale<this.scale||.1<Math.abs(s-1)||this.panMode===S||!1===d)&&!c&&this.clampTargetBounds(),u===m.Init?this.animate():this.isResting||(this.state=m.Panning,this.requestTick())}}stop(e=!1){if(this.state!==m.Init&&this.state!==m.Destroy){let t=this.isTicking;this.rAF&&(cancelAnimationFrame(this.rAF),this.rAF=null),this.isBouncingX=!1,this.isBouncingY=!1;for(let t of b)this.velocity[t]=0,"current"===e?this.current[t]=this.target[t]:"target"===e&&(this.target[t]=this.current[t]);this.setTransform(),y(this.container,"is-scaling"),y(this.container,"is-animating"),this.isTicking=!1,this.state=m.Ready,t&&(this.emit("endAnimation"),this.updateControls())}}requestTick(){this.isTicking||(this.emit("startAnimation"),this.updateControls(),w(this.container,"is-animating"),this.isScaling&&w(this.container,"is-scaling")),this.isTicking=!0,this.rAF||(this.rAF=requestAnimationFrame(()=>this.animate()))}panWithMouse(i,s=this.option("mouseMoveFriction")){if(this.pmme=i,this.panMode===S&&i&&!(P(this.targetScale)<=P(this.minScale))){this.emit("mouseMove",i);var{container:n,containerRect:a,contentRect:o}=this,r=a.width,a=a.height,n=n.getBoundingClientRect(),l=(i.clientX||0)-n.left,i=(i.clientY||0)-n.top;let{contentWidth:t,contentHeight:e}=this.calculateContentDim(this.target);n=this.option("mouseMoveFactor"),n=(1<n&&(t!==r&&(t*=n),e!==a)&&(e*=n),.5*(t-r)-l/r*100/100*(t-r)),l=(n+=.5*(o.right-o.left),.5*(e-a)-i/a*100/100*(e-a));l+=.5*(o.bottom-o.top),this.applyChange({panX:n-this.target.e,panY:l-this.target.f,friction:s})}}zoomWithWheel(e){if(this.state!==m.Destroy&&this.state!==m.Init){var i=Date.now();if(i-this.pwt<45)e.preventDefault();else{this.pwt=i;var i=[-e.deltaX||0,-e.deltaY||0,-e.detail||0].reduce(function(t,e){return Math.abs(e)>Math.abs(t)?e:t}),i=Math.max(-1,Math.min(1,i)),{targetScale:s,maxScale:n,minScale:a}=this;let t=s*(100+45*i)/100;t=P(t)<P(a)&&P(s)<=P(a)?(this.cwd+=Math.abs(i),a):P(t)>P(n)&&P(s)>=P(n)?(this.cwd+=Math.abs(i),n):(this.cwd=0,Math.max(Math.min(t,n),a)),this.cwd>this.option("wheelLimit")||(e.preventDefault(),P(t)!==P(s)&&this.zoomTo(t,{event:e}))}}}canZoomIn(){return this.option("zoom")&&(P(this.contentRect.width,1)<P(this.contentRect.fitWidth,1)||P(this.targetScale)<P(this.maxScale))}canZoomOut(){return this.option("zoom")&&P(this.targetScale)>P(this.minScale)}zoomIn(t=1.25,e){this.zoomTo(this.targetScale*t,e)}zoomOut(t=.8,e){this.zoomTo(this.targetScale*t,e)}zoomToFit(t){this.zoomTo("fit",t)}zoomToCover(t){this.zoomTo("cover",t)}zoomToFull(t){this.zoomTo("full",t)}zoomToMax(t){this.zoomTo("max",t)}toggleZoom(t){this.zoomTo(this.getNextScale("toggleZoom"),t)}toggleMax(t){this.zoomTo(this.getNextScale("toggleMax"),t)}toggleCover(t){this.zoomTo(this.getNextScale("toggleCover"),t)}iterateZoom(t){this.zoomTo("next",t)}zoomTo(a=1,{friction:o=M,originX:r=M,originY:l=M,event:h}={}){if(!this.isContentLoading&&this.state!==m.Destroy){let{targetScale:t,fullScale:e,maxScale:i,coverScale:s}=this;if(this.stop(),(h=this.panMode===S?this.pmme||h:h)||r===M||l===M){let t=this.content.getBoundingClientRect(),e=this.container.getBoundingClientRect(),i=h?h.clientX:e.left+.5*e.width,s=h?h.clientY:e.top+.5*e.height;r=i-t.left-.5*t.width,l=s-t.top-.5*t.height}let n=1;"number"==typeof a?n=a:"full"===a?n=e:"cover"===a?n=s:"max"===a?n=i:"fit"===a?n=1:"next"===a&&(n=this.getNextScale("iterateZoom")),n=n/t||1,o=o===M?1<n?.15:.25:o,this.applyChange({scale:n,originX:r,originY:l,friction:o}),h&&this.panMode===S&&this.panWithMouse(h,o)}}rotateCCW(){this.applyChange({angle:-90})}rotateCW(){this.applyChange({angle:90})}flipX(){this.applyChange({flipX:!0})}flipY(){this.applyChange({flipY:!0})}fitX(){this.stop("target");var{containerRect:t,contentRect:e,target:i}=this;this.applyChange({panX:.5*t.width-(e.left+.5*e.fitWidth)-i.e,panY:.5*t.height-(e.top+.5*e.fitHeight)-i.f,scale:t.width/e.fitWidth/this.targetScale,originX:0,originY:0,ignoreBounds:!0})}fitY(){this.stop("target");var{containerRect:t,contentRect:e,target:i}=this;this.applyChange({panX:.5*t.width-(e.left+.5*e.fitWidth)-i.e,panY:.5*t.innerHeight-(e.top+.5*e.fitHeight)-i.f,scale:t.height/e.fitHeight/this.targetScale,originX:0,originY:0,ignoreBounds:!0})}toggleFS(){var t=this.container,e=this.cn("inFullscreen"),i=this.cn("htmlHasFullscreen"),t=(t.classList.toggle(e),t.classList.contains(e));t?(document.documentElement.classList.add(i),document.addEventListener("keydown",this.onKeydown,!0)):(document.documentElement.classList.remove(i),document.removeEventListener("keydown",this.onKeydown,!0)),this.updateMetrics(),this.emit(t?"enterFS":"exitFS")}getMatrix(t=this.current){var{a:t,b:e,c:i,d:s,e:n,f:a}=t;return new DOMMatrix([t,e,i,s,n,a])}reset(t){if(this.state!==m.Init&&this.state!==m.Destroy){this.stop("current");for(let t of b)this.target[t]=x[t];this.target.a=this.minScale,this.target.d=this.minScale,this.clampTargetBounds(),this.isResting||(this.friction=void 0===t?this.option("friction"):t,this.state=m.Panning,this.requestTick())}}destroy(){this.stop(),this.state=m.Destroy,this.detachEvents(),this.detachObserver();let{container:e,content:t}=this,i=this.option("classes")||{};for(let t of Object.values(i))e.classList.remove(t+"");t&&(t.removeEventListener("load",this.onLoad),t.removeEventListener("error",this.onError)),this.detachPlugins()}}Object.defineProperty(k,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:{content:null,width:"auto",height:"auto",panMode:"drag",touch:!0,dragMinThreshold:3,lockAxis:!1,mouseMoveFactor:1,mouseMoveFriction:.12,zoom:!0,pinchToZoom:!0,panOnlyZoomed:"auto",minScale:1,maxScale:2,friction:.25,dragFriction:.35,decelFriction:.05,click:"toggleZoom",dblClick:!1,wheel:"zoom",wheelLimit:7,spinner:!0,bounds:"auto",infinite:!1,rubberband:!0,bounce:!0,maxVelocity:75,transformParent:!1,classes:{content:"f-panzoom__content",isLoading:"is-loading",canZoomIn:"can-zoom_in",canZoomOut:"can-zoom_out",isDraggable:"is-draggable",isDragging:"is-dragging",inFullscreen:"in-fullscreen",htmlHasFullscreen:"with-panzoom-in-fullscreen"},l10n:{PANUP:"Move up",PANDOWN:"Move down",PANLEFT:"Move left",PANRIGHT:"Move right",ZOOMIN:"Zoom in",ZOOMOUT:"Zoom out",TOGGLEZOOM:"Toggle zoom level",TOGGLE1TO1:"Toggle zoom level",ITERATEZOOM:"Toggle zoom level",ROTATECCW:"Rotate counterclockwise",ROTATECW:"Rotate clockwise",FLIPX:"Flip horizontally",FLIPY:"Flip vertically",FITX:"Fit horizontally",FITY:"Fit vertically",RESET:"Reset",TOGGLEFS:"Toggle fullscreen"}}}),Object.defineProperty(k,"Plugins",{enumerable:!0,configurable:!0,writable:!0,value:{}});function X(e,i){let s=!0;return(...t)=>{s&&(s=!1,e(...t),setTimeout(()=>{s=!0},i))}}let W=(t,e)=>{let i=[];return t.childNodes.forEach(t=>{t.nodeType!==Node.ELEMENT_NODE||e&&!t.matches(e)||i.push(t)}),i},z=((c=v=v||{})[c.Init=0]="Init",c[c.Ready=1]="Ready",c[c.Destroy=2]="Destroy",t=>{var e;return"string"==typeof t||t instanceof HTMLElement?t={html:t}:void 0!==(e=t.thumb)&&("string"==typeof e&&(t.thumbSrc=e),e instanceof HTMLImageElement&&(t.thumbEl=e,t.thumbElSrc=e.src,t.thumbSrc=e.src),delete t.thumb),Object.assign({html:"",el:null,isDom:!1,class:"",customClass:"",index:-1,dim:0,gap:0,pos:0,transition:!1},t)});class L extends e{constructor(t,e){super(e),Object.defineProperty(this,"instance",{enumerable:!0,configurable:!0,writable:!0,value:t})}attach(){}detach(){}}class Y extends L{constructor(){super(...arguments),Object.defineProperty(this,"isDynamic",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"list",{enumerable:!0,configurable:!0,writable:!0,value:null})}onRefresh(){this.refresh()}build(){let t=this.list;var e;return t||(t=document.createElement("ul"),w(t,this.cn("list")),t.setAttribute("role","tablist"),(e=this.instance.container).appendChild(t),w(e,this.cn("hasDots")),this.list=t),t}refresh(){var s;let e=this.instance.pages.length,t=Math.min(2,this.option("minCount")),i=Math.max(2e3,this.option("maxCount")),a=this.option("dynamicFrom");if(e<t||e>i)this.cleanup();else{var o="number"==typeof a&&5<e&&e>=a,r=!this.list||this.isDynamic!==o||this.list.children.length!==e,l=(r&&this.cleanup(),this.build());if(p(l,this.cn("isDynamic"),!!o),r)for(let t=0;t<e;t++)l.append(this.createItem(t));let n,i=0;for(let e of[...l.children]){let t=i===this.instance.page;t&&(n=e),p(e,this.cn("isCurrent"),t),null!=(s=e.children[0])&&s.setAttribute("aria-selected",t?"true":"false");for(let t of["isBeforePrev","isPrev","isNext","isAfterNext"])y(e,this.cn(t));i++}if(n=n||l.firstChild,o&&n){let t=n.previousElementSibling,e=t&&t.previousElementSibling,i=(w(t,this.cn("isPrev")),w(e,this.cn("isBeforePrev")),n.nextElementSibling),s=i&&i.nextElementSibling;w(i,this.cn("isNext")),w(s,this.cn("isAfterNext"))}this.isDynamic=o}}createItem(t=0){var e=document.createElement("li"),t=(e.setAttribute("role","presentation"),l(this.instance.localize(this.option("dotTpl"),[["%d",t+1]]).replace(/\%i/g,t+"")));return e.appendChild(t),null!=(t=e.children[0])&&t.setAttribute("role","tab"),e}cleanup(){this.list&&(this.list.remove(),this.list=null),this.isDynamic=!1,y(this.instance.container,this.cn("hasDots"))}attach(){this.instance.on(["refresh","change"],this.onRefresh)}detach(){this.instance.off(["refresh","change"],this.onRefresh),this.cleanup()}}Object.defineProperty(Y,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:{classes:{list:"f-carousel__dots",isDynamic:"is-dynamic",hasDots:"has-dots",dot:"f-carousel__dot",isBeforePrev:"is-before-prev",isPrev:"is-prev",isCurrent:"is-current",isNext:"is-next",isAfterNext:"is-after-next"},dotTpl:'<button type="button" data-carousel-page="%i" aria-label="{{GOTO}}"><span class="f-carousel__dot" aria-hidden="true"></span></button>',dynamicFrom:11,maxCount:1/0,minCount:2}});let D="disabled",C="next",Z="prev";class V extends L{constructor(){super(...arguments),Object.defineProperty(this,"container",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"prev",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"next",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"isDom",{enumerable:!0,configurable:!0,writable:!0,value:!1})}onRefresh(){var t,e,i=this.instance,s=i.pages.length,n=i.page;s<2?this.cleanup():(this.build(),t=this.prev,e=this.next,t&&e&&(t.removeAttribute(D),e.removeAttribute(D),i.isInfinite||(n<=0&&t.setAttribute(D,""),s-1<=n&&e.setAttribute(D,""))))}addBtn(t){var e=this.instance,i=document.createElement("button"),s=(i.setAttribute("tabindex","0"),i.setAttribute("title",e.localize(`{{${t.toUpperCase()}}}`)),w(i,this.cn("button")+" "+this.cn(t===C?"isNext":"isPrev")),e.isRTL?t===C?Z:C:t);return i.innerHTML=e.localize(this.option(s+"Tpl")),i.dataset["carousel"+((e=t)?e.match("^[a-z]")?e.charAt(0).toUpperCase()+e.substring(1):e:"")]="true",null!=(s=this.container)&&s.appendChild(i),i}build(){var t=this.instance.container,e=this.cn("container");let{container:i,prev:s,next:n}=this;i||(i=t.querySelector("."+e),this.isDom=!!i),i||(i=document.createElement("div"),w(i,e),t.appendChild(i)),this.container=i,n=(n=n||i.querySelector("[data-carousel-next]"))||this.addBtn(C),this.next=n,s=(s=s||i.querySelector("[data-carousel-prev]"))||this.addBtn(Z),this.prev=s}cleanup(){this.isDom||(this.prev&&this.prev.remove(),this.next&&this.next.remove(),this.container&&this.container.remove()),this.prev=null,this.next=null,this.container=null,this.isDom=!1}attach(){this.instance.on(["refresh","change"],this.onRefresh)}detach(){this.instance.off(["refresh","change"],this.onRefresh),this.cleanup()}}Object.defineProperty(V,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:{classes:{container:"f-carousel__nav",button:"f-button",isNext:"is-next",isPrev:"is-prev"},nextTpl:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" tabindex="-1"><path d="M9 3l9 9-9 9"/></svg>',prevTpl:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" tabindex="-1"><path d="M15 3l-9 9 9 9"/></svg>'}});class q extends L{constructor(){super(...arguments),Object.defineProperty(this,"selectedIndex",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"target",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"nav",{enumerable:!0,configurable:!0,writable:!0,value:null})}addAsTargetFor(t){this.target=this.instance,this.nav=t,this.attachEvents()}addAsNavFor(t){this.nav=this.instance,this.target=t,this.attachEvents()}attachEvents(){var{nav:t,target:e}=this;t&&e&&(t.options.initialSlide=e.options.initialPage,t.state===v.Ready?this.onNavReady(t):t.on("ready",this.onNavReady),e.state===v.Ready?this.onTargetReady(e):e.on("ready",this.onTargetReady))}onNavReady(t){t.on("createSlide",this.onNavCreateSlide),t.on("Panzoom.click",this.onNavClick),t.on("Panzoom.touchEnd",this.onNavTouch),this.onTargetChange()}onTargetReady(t){t.on("change",this.onTargetChange),t.on("Panzoom.refresh",this.onTargetChange),this.onTargetChange()}onNavClick(t,e,i){this.onNavTouch(t,t.panzoom,i)}onNavTouch(t,e,i){var s,n,a;3<Math.abs(e.dragOffset.x)||3<Math.abs(e.dragOffset.y)||(e=i.target,{nav:s,target:n}=this,s&&n&&e&&(e=e.closest("[data-index]"),i.stopPropagation(),i.preventDefault(),e)&&(i=parseInt(e.dataset.index||"",10)||0,e=n.getPageForSlide(i),a=s.getPageForSlide(i),s.slideTo(a),n.slideTo(e,{friction:(null==(a=null==(s=this.nav)?void 0:s.plugins)?void 0:a.Sync.option("friction"))||0}),this.markSelectedSlide(i)))}onNavCreateSlide(t,e){e.index===this.selectedIndex&&this.markSelectedSlide(e.index)}onTargetChange(){var t,e,{target:i,nav:s}=this;i&&s&&s.state===v.Ready&&i.state===v.Ready&&(t=null==(t=null==(t=i.pages[i.page])?void 0:t.slides[0])?void 0:t.index,e=s.getPageForSlide(t),this.markSelectedSlide(t),s.slideTo(e,null===s.prevPage&&null===i.prevPage?{friction:0}:void 0))}markSelectedSlide(e){var t=this.nav;t&&t.state===v.Ready&&(this.selectedIndex=e,[...t.slides].map(t=>{t.el&&t.el.classList[t.index===e?"add":"remove"]("is-nav-selected")}))}attach(){var t=this.options.target,e=this.options.nav;t?this.addAsNavFor(t):e&&this.addAsTargetFor(e)}detach(){var t=this,e=t.nav,i=t.target;e&&(e.off("ready",t.onNavReady),e.off("createSlide",t.onNavCreateSlide),e.off("Panzoom.click",t.onNavClick),e.off("Panzoom.touchEnd",t.onNavTouch)),t.nav=null,i&&(i.off("ready",t.onTargetReady),i.off("refresh",t.onTargetChange),i.off("change",t.onTargetChange)),t.target=null}}Object.defineProperty(q,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:{friction:.35}});let _={Navigation:V,Dots:Y,Sync:q},R="animationend",$="isSelected",A="slide";class j extends i{get axis(){return this.isHorizontal?"e":"f"}get isEnabled(){return this.state===v.Ready}get isInfinite(){let t=!1;var{contentDim:e,viewportDim:i,pages:s,slides:n}=this,n=n[0];return t=2<=s.length&&n&&e+n.dim>=i?this.option("infinite"):t}get isRTL(){return"rtl"===this.option("direction")}get isHorizontal(){return"x"===this.option("axis")}constructor(t,e={},i={}){if(super(),Object.defineProperty(this,"bp",{enumerable:!0,configurable:!0,writable:!0,value:""}),Object.defineProperty(this,"lp",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"userOptions",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"userPlugins",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:v.Init}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"prevPage",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"container",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"viewport",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"track",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"slides",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"pages",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"panzoom",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"inTransition",{enumerable:!0,configurable:!0,writable:!0,value:new Set}),Object.defineProperty(this,"contentDim",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"viewportDim",{enumerable:!0,configurable:!0,writable:!0,value:0}),!(t="string"==typeof t?document.querySelector(t):t)||!d(t))throw new Error("No Element found");this.container=t,this.slideNext=X(this.slideNext.bind(this),150),this.slidePrev=X(this.slidePrev.bind(this),150),this.userOptions=e,this.userPlugins=i,queueMicrotask(()=>{this.processOptions()})}processOptions(){var t,e,i=h({},j.defaults,this.userOptions);let s="";var n=i.breakpoints;if(n&&r(n))for(let[t,e]of Object.entries(n))window.matchMedia(t).matches&&r(e)&&(s+=t,h(i,e));s===this.bp&&this.state!==v.Init||(this.bp=s,this.state===v.Ready&&(i.initialSlide=(null==(e=null==(t=this.pages[this.page])?void 0:t.slides[0])?void 0:e.index)||0),this.state!==v.Init&&this.destroy(),super.setOptions(i),!1===this.option("enabled")?this.attachEvents():setTimeout(()=>{this.init()},0))}init(){this.state=v.Init,this.emit("init"),this.attachPlugins(Object.assign(Object.assign({},j.Plugins),this.userPlugins)),this.emit("attachPlugins"),this.initLayout(),this.initSlides(),this.updateMetrics(),this.setInitialPosition(),this.initPanzoom(),this.attachEvents(),this.state=v.Ready,this.emit("ready")}initLayout(){var t=this.container,e=this.option("classes");w(t,this.cn("container")),p(t,e.isLTR,!this.isRTL),p(t,e.isRTL,this.isRTL),p(t,e.isVertical,!this.isHorizontal),p(t,e.isHorizontal,this.isHorizontal);let i=this.option("viewport")||t.querySelector("."+e.viewport),s=(i||(i=document.createElement("div"),w(i,e.viewport),i.append(...W(t,"."+e.slide)),t.prepend(i)),i.addEventListener("scroll",this.onScroll),this.option("track")||t.querySelector("."+e.track));s||(s=document.createElement("div"),w(s,e.track),s.append(...Array.from(i.childNodes))),s.setAttribute("aria-live","polite"),i.contains(s)||i.prepend(s),this.viewport=i,this.track=s,this.emit("initLayout")}initSlides(){let i=this.track;if(i){let t=[...this.slides],e=[];[...W(i,"."+this.cn(A))].forEach(t=>{d(t)&&(t=z({el:t,isDom:!0,index:this.slides.length}),e.push(t))});for(var s of[...this.option("slides",[])||[],...t])e.push(z(s));this.slides=e;for(let t=0;t<this.slides.length;t++)this.slides[t].index=t;for(let t of e)this.emit("beforeInitSlide",t,t.index),this.emit("initSlide",t,t.index);this.emit("initSlides")}}setInitialPage(){var t=this.option("initialSlide");this.page="number"==typeof t?this.getPageForSlide(t):parseInt(this.option("initialPage",0)+"",10)||0}setInitialPosition(){var{track:e,pages:i,isHorizontal:s}=this;if(e&&i.length){let t=this.page;i[t]||(this.page=t=0);i=(i[t].pos||0)*(this.isRTL&&s?1:-1);e.style.transform=`translate3d(${s?i+"px":"0"}, ${s?"0":i+"px"}, 0) scale(1)`,this.option("adaptiveHeight")&&this.setViewportHeight()}}initPanzoom(){this.panzoom&&(this.panzoom.destroy(),this.panzoom=null);var t=this.option("Panzoom")||{};this.panzoom=new k(this.viewport,h({},{content:this.track,zoom:!1,panOnlyZoomed:!1,lockAxis:this.isHorizontal?"x":"y",infinite:this.isInfinite,click:!1,dblClick:!1,touch:t=>!(this.pages.length<2&&!t.options.infinite),bounds:()=>this.getBounds(),maxVelocity:t=>Math.abs(t.target[this.axis]-t.current[this.axis])<2*this.viewportDim?100:0},t)),this.panzoom.on("*",(t,e,...i)=>{this.emit("Panzoom."+e,t,...i)}),this.panzoom.on("decel",this.onDecel),this.panzoom.on("refresh",this.onRefresh),this.panzoom.on("beforeTransform",this.onBeforeTransform),this.panzoom.on("endAnimation",this.onEndAnimation)}attachEvents(){var t=this.container;t&&(t.addEventListener("click",this.onClick,{passive:!1,capture:!1}),t.addEventListener("slideTo",this.onSlideTo)),window.addEventListener("resize",this.onResize)}createPages(){var e=[];let{contentDim:t,viewportDim:i}=this;var s,n=("auto"===(n=this.option("slidesPerPage"))||t<=i)&&!1!==this.option("fill")?1/0:parseFloat(n+"");let a=0,o=0,r=0;for(let t of this.slides)(!e.length||.05<o+t.dim-i||r>=n)&&(e.push((s={},Object.assign({index:-1,slides:[],dim:0,pos:-1},s))),a=e.length-1,o=0,r=0),e[a].slides.push(t),o+=t.dim+t.gap,r++;return e}processPages(){let t=this.pages,{contentDim:e,viewportDim:s,isInfinite:i}=this,n=this.option("center"),a=this.option("fill"),o=a&&n&&e>s&&!i;if(t.forEach((i,t)=>{i.index=t,i.pos=(null==(t=i.slides[0])?void 0:t.pos)||0,i.dim=0;for(let[t,e]of i.slides.entries())i.dim+=e.dim,t<i.slides.length-1&&(i.dim+=e.gap);o&&i.pos+.5*i.dim<.5*s?i.pos=0:o&&i.pos+.5*i.dim>=e-.5*s?i.pos=e-s:n&&(i.pos+=-.5*(s-i.dim))}),t.forEach(t=>{a&&!i&&e>s&&(t.pos=Math.max(t.pos,0),t.pos=Math.min(t.pos,e-s)),t.pos=P(t.pos,1e3),t.dim=P(t.dim,1e3),Math.abs(t.pos)<=.1&&(t.pos=0)}),i)return t;let r=[],l;return t.forEach(t=>{t=Object.assign({},t);l&&t.pos===l.pos?(l.dim+=t.dim,l.slides=[...l.slides,...t.slides]):(t.index=r.length,l=t,r.push(t))}),r}getPageFromIndex(t=0){var e=this.pages.length;return t=parseInt((t||0).toString())||0,this.isInfinite?(t%e+e)%e:Math.max(Math.min(t,e-1),0)}getSlideMetrics(t){var e=this.isHorizontal?"width":"height";let i=0,s,n=t.el;var a=!(!n||n.parentNode),e=(n?i=parseFloat(n.dataset[e]||"")||0:((n=document.createElement("div")).style.visibility="hidden",(this.track||document.body).prepend(n)),w(n,this.cn(A)+" "+t.class+" "+t.customClass),i?(n.style[e]=i+"px",n.style["width"==e?"height":"width"]=""):(a&&(this.track||document.body).prepend(n),i=n.getBoundingClientRect()[e]*Math.max(1,(null==(e=window.visualViewport)?void 0:e.scale)||1),(e=n[this.isHorizontal?"offsetWidth":"offsetHeight"])-1>i&&(i=e)),getComputedStyle(n));return"content-box"===e.boxSizing&&(this.isHorizontal?i=(i+=parseFloat(e.paddingLeft)||0)+(parseFloat(e.paddingRight)||0):i=(i+=parseFloat(e.paddingTop)||0)+(parseFloat(e.paddingBottom)||0)),s=parseFloat(e[this.isHorizontal?"marginRight":"marginBottom"])||0,a?null!=(e=n.parentElement)&&e.removeChild(n):t.el||n.remove(),{dim:P(i,1e3),gap:P(s,1e3)}}getBounds(){let{isInfinite:t,isRTL:i,isHorizontal:s,pages:n}=this,a={min:0,max:0};if(t)a={min:-1/0,max:1/0};else if(n.length){let t=n[0].pos,e=n[n.length-1].pos;a=i&&s?{min:t,max:e}:{min:-1*e,max:-1*t}}return{x:s?a:{min:0,max:0},y:s?{min:0,max:0}:a}}repositionSlides(){let i,{isHorizontal:t,isRTL:e,isInfinite:s,viewport:n,viewportDim:a,contentDim:o,page:r,pages:l,slides:h,panzoom:c}=this,d=0,u=0,g=0,p=0;c?p=-1*c.current[this.axis]:l[r]&&(p=l[r].pos||0),i=t?e?"right":"left":"top",e&&t&&(p*=-1);for(let e of h){let t=e.el;t?("top"==i?(t.style.right="",t.style.left=""):t.style.top="",e.index!==d?t.style[i]=0===u?"":P(u,1e3)+"px":t.style[i]="",g+=e.dim+e.gap,d++):u+=e.dim+e.gap}if(s&&g&&n){var f=getComputedStyle(n),m="padding",v=t?"Right":"Bottom",b=parseFloat(f[m+(t?"Left":"Top")]);p-=b,a=(a+=b)+parseFloat(f[m+v]);for(let t of h)t.el&&(P(t.pos)<P(a)&&P(t.pos+t.dim+t.gap)<P(p)&&P(p)>P(o-a)&&(t.el.style[i]=P(u+g,1e3)+"px"),P(t.pos+t.gap)>=P(o-a))&&P(t.pos)>P(p+a)&&P(p)<P(a)&&(t.el.style[i]=`-${P(g,1e3)}px`)}let y,w,x=[...this.inTransition];if(1<x.length&&(y=l[x[0]],w=l[x[1]]),y&&w){let e=0;for(let t of h)t.el?this.inTransition.has(t.index)&&y.slides.indexOf(t)<0&&(t.el.style[i]=P(e+(y.pos-w.pos),1e3)+"px"):e+=t.dim+t.gap}}createSlideEl(e){var{track:n,slides:a}=this;if(n&&e&&(!e.el||!e.el.parentNode)){var o=e.el||document.createElement("div"),r=(w(o,this.cn(A)),w(o,e.class),w(o,e.customClass),e.html);r&&(r instanceof HTMLElement?o.appendChild(r):o.innerHTML=e.html+"");let i=[],s=(a.forEach((t,e)=>{t.el&&i.push(e)}),e.index),t=null;r=(t=i.length?a[i.reduce((t,e)=>Math.abs(e-s)<Math.abs(t-s)?e:t)]:t)&&t.el&&t.el.parentNode?t.index<e.index?t.el.nextSibling:t.el:null;n.insertBefore(o,n.contains(r)?r:null),e.el=o,this.emit("createSlide",e)}}removeSlideEl(t,e=!1){var i,s=null==t?void 0:t.el;s&&s.parentNode&&(i=this.cn($),s.classList.contains(i)&&(y(s,i),this.emit("unselectSlide",t)),t.isDom&&!e?(s.removeAttribute("aria-hidden"),s.removeAttribute("data-index"),s.style.left=""):(this.emit("removeSlide",t),i=new CustomEvent(R),s.dispatchEvent(i),t.el&&(t.el.remove(),t.el=null)))}transitionTo(t=0,e=this.option("transition")){if(!e)return!1;var i=this.page,{pages:s,panzoom:n}=this,a=(t=parseInt((t||0).toString())||0,this.getPageFromIndex(t));if(!n||!s[a]||s.length<2||1<Math.abs(((null==(r=null==(r=s[i])?void 0:r.slides[0])?void 0:r.dim)||0)-this.viewportDim))return!1;let o=i<t?1:-1;this.isInfinite&&(0===i&&t===s.length-1&&(o=-1),i===s.length-1)&&0===t&&(o=1);var r=s[a].pos*(this.isRTL?1:-1);if(i===a&&Math.abs(r-n.target[this.axis])<1)return!1;this.clearTransitions();t=n.isResting,w(this.container,this.cn("inTransition")),i=(null==(i=s[i])?void 0:i.slides[0])||null,s=(null==(s=s[a])?void 0:s.slides[0])||null;this.inTransition.add(s.index),this.createSlideEl(s);let l=i.el,h=s.el;t||e===A||(e="fadeFast",l=null);var t=this.isRTL?"next":"prev",c=this.isRTL?"prev":"next";return l&&(this.inTransition.add(i.index),i.transition=e,l.addEventListener(R,this.onAnimationEnd),l.classList.add(`f-${e}Out`,"to-"+(0<o?c:t))),h&&(s.transition=e,h.addEventListener(R,this.onAnimationEnd),h.classList.add(`f-${e}In`,"from-"+(0<o?t:c))),n.current[this.axis]=r,n.target[this.axis]=r,n.requestTick(),this.onChange(a),!0}manageSlideVisiblity(){let e=new Set,i=new Set,t=this.getVisibleSlides(parseFloat(this.option("preload",0)+"")||0);for(var s of this.slides)(t.has(s)?e:i).add(s);for(let t of this.inTransition)e.add(this.slides[t]);for(let t of e)this.createSlideEl(t),this.lazyLoadSlide(t);for(let t of i)e.has(t)||this.removeSlideEl(t);this.markSelectedSlides(),this.repositionSlides()}markSelectedSlides(){if(this.pages[this.page]&&this.pages[this.page].slides){var t="aria-hidden",e=this.cn($);if(e)for(var i of this.slides){var s=i.el;s&&(s.dataset.index=""+i.index,s.classList.contains("f-thumbs__slide")?this.getVisibleSlides(0).has(i)?s.removeAttribute(t):s.setAttribute(t,"true"):this.pages[this.page].slides.includes(i)?(s.classList.contains(e)||(w(s,e),this.emit("selectSlide",i)),s.removeAttribute(t)):(s.classList.contains(e)&&(y(s,e),this.emit("unselectSlide",i)),s.setAttribute(t,"true")))}}}flipInfiniteTrack(){var{axis:n,isHorizontal:a,isInfinite:t,isRTL:o,viewportDim:r,contentDim:l}=this,h=this.panzoom;if(h&&t){let t=h.current[n],e=h.target[n]-t,i=0,s=.5*r;o&&a?(t<-s&&(i=-1,t+=l),t>l-s&&(i=1,t-=l)):(t>s&&(i=1,t-=l),t<s-l&&(i=-1,t+=l)),i&&(h.current[n]=t,h.target[n]=t+e)}}lazyLoadImg(e,i){let t=this,s="f-fadeIn",n="is-preloading",a=!1,o=null,r=()=>{a||(a=!0,o&&(o.remove(),o=null),y(i,n),i.complete&&(w(i,s),setTimeout(()=>{y(i,s)},350)),this.option("adaptiveHeight")&&e.el&&-1<this.pages[this.page].slides.indexOf(e)&&(t.updateMetrics(),t.setViewportHeight()),this.emit("load",e))};w(i,n),i.src=i.dataset.lazySrcset||i.dataset.lazySrc||"",delete i.dataset.lazySrc,delete i.dataset.lazySrcset,i.addEventListener("error",()=>{r()}),i.addEventListener("load",()=>{r()}),setTimeout(()=>{var t=i.parentNode;t&&e.el&&(i.complete?r():a||(o=l(B),t.insertBefore(o,i)))},300)}lazyLoadSlide(i){let t=i&&i.el;if(t){let e=new Set;var s=Array.from(t.querySelectorAll("[data-lazy-src],[data-lazy-srcset]"));t.dataset.lazySrc&&s.push(t),s.map(t=>{t instanceof HTMLImageElement?e.add(t):t instanceof HTMLElement&&t.dataset.lazySrc&&(t.style.backgroundImage=`url('${t.dataset.lazySrc}')`,delete t.dataset.lazySrc)});for(let t of e)this.lazyLoadImg(i,t)}}onAnimationEnd(t){var e=t.target,i=e?parseInt(e.dataset.index||"",10)||0:-1,s=this.slides[i],t=t.animationName;e&&s&&t&&((e=!!this.inTransition.has(i)&&s.transition)&&t.substring(0,e.length+2)==="f-"+e&&this.inTransition.delete(i),this.inTransition.size||this.clearTransitions(),i===this.page)&&null!=(s=this.panzoom)&&s.isResting&&this.emit("settle")}onDecel(i,s=0,n=0,a=0,o=0){if(this.option("dragFree"))this.setPageFromPosition();else{var{isRTL:r,isHorizontal:l,axis:h,pages:c}=this,t=c.length,d=Math.abs(Math.atan2(n,s)/(Math.PI/180)),d=45<d&&d<135?l?0:n:l?s:0;if(t){let t=this.page,e=r&&l?1:-1;n=i.current[h]*e,s=this.getPageFromPosition(n).pageIndex;t=5<Math.abs(d)?(c[t].dim<document.documentElement["client"+(this.isHorizontal?"Width":"Height")]-1&&(t=s),r&&l?d<0?t-1:t+1:d<0?t+1:t-1):0===a&&0===o?t:s,this.slideTo(t,{transition:!1,friction:i.option("decelFriction")})}}}onClick(t){var e=t.target,i=e&&d(e)?e.dataset:null;let s,n;i&&(void 0!==i.carouselPage?(n="slideTo",s=i.carouselPage):void 0!==i.carouselNext?n="slideNext":void 0!==i.carouselPrev&&(n="slidePrev")),n?(t.preventDefault(),t.stopPropagation(),e&&!e.hasAttribute("disabled")&&this[n](s)):this.emit("click",t)}onSlideTo(t){t=t.detail||0;this.slideTo(this.getPageForSlide(t),{friction:0})}onChange(t,e=0){var i=this.page;this.prevPage=i,this.page=t,this.option("adaptiveHeight")&&this.setViewportHeight(),t!==i&&(this.markSelectedSlides(),this.emit("change",t,i,e))}onRefresh(){var t=this.contentDim,e=this.viewportDim;this.updateMetrics(),this.contentDim===t&&this.viewportDim===e||this.slideTo(this.page,{friction:0,transition:!1})}onScroll(){var t;null!=(t=this.viewport)&&t.scroll(0,0)}onResize(){this.option("breakpoints")&&this.processOptions()}onBeforeTransform(t){this.lp!==t.current[this.axis]&&(this.flipInfiniteTrack(),this.manageSlideVisiblity()),this.lp=t.current.e}onEndAnimation(){this.inTransition.size||this.emit("settle")}reInit(t=null,e=null){this.destroy(),this.state=v.Init,this.prevPage=null,this.userOptions=t||this.userOptions,this.userPlugins=e||this.userPlugins,this.processOptions()}slideTo(s=0,{friction:t=this.option("friction"),transition:e=this.option("transition")}={}){if(this.state!==v.Destroy){s=parseInt((s||0).toString())||0;var i=this.getPageFromIndex(s),{axis:n,isHorizontal:a,isRTL:o,pages:r,panzoom:l}=this,h=r.length,o=o&&a?1:-1;if(l&&h){if(this.page!==i){let t=new Event("beforeChange",{bubbles:!0,cancelable:!0});if(this.emit("beforeChange",t,s),t.defaultPrevented)return}if(!this.transitionTo(s,e)){let e=r[i].pos;if(this.isInfinite){let t=this.contentDim,i=l.target[n]*o;2===h?e+=t*Math.floor(parseFloat(s+"")/2):e=[e,e-t,e+t].reduce(function(t,e){return Math.abs(e-i)<Math.abs(t-i)?e:t})}e*=o,Math.abs(l.target[n]-e)<1||(l.panTo({x:a?e:0,y:a?0:e,friction:t}),this.onChange(i))}}}}slideToClosest(t){var e;this.panzoom&&(e=this.getPageFromPosition().pageIndex,this.slideTo(e,t))}slideNext(){this.slideTo(this.page+1)}slidePrev(){this.slideTo(this.page-1)}clearTransitions(){this.inTransition.clear(),y(this.container,this.cn("inTransition"));var t,e=["to-prev","to-next","from-prev","from-next"];for(t of this.slides){var i,s=t.el;s&&(s.removeEventListener(R,this.onAnimationEnd),s.classList.remove(...e),i=t.transition)&&s.classList.remove(`f-${i}Out`,`f-${i}In`)}this.manageSlideVisiblity()}addSlide(a,t){var e,i,o,r=this.panzoom,l=(null==(e=this.pages[this.page])?void 0:e.pos)||0,h=(null==(i=this.pages[this.page])?void 0:i.dim)||0,c=this.contentDim<this.viewportDim;let s=Array.isArray(t)?t:[t],n=[];for(let t of s)n.push(z(t));this.slides.splice(a,0,...n);for(let t=0;t<this.slides.length;t++)this.slides[t].index=t;for(let t of n)this.emit("beforeInitSlide",t,t.index);if(this.page>=a&&(this.page+=n.length),this.updateMetrics(),r){let t=(null==(o=this.pages[this.page])?void 0:o.pos)||0,e=(null==(o=this.pages[this.page])?void 0:o.dim)||0,i=this.pages.length||1,s=this.isRTL?h-e:e-h,n=this.isRTL?l-t:t-l;c&&1===i?(a<=this.page&&(r.current[this.axis]-=s,r.target[this.axis]-=s),r.panTo({[this.isHorizontal?"x":"y"]:-1*t})):n&&a<=this.page&&(r.target[this.axis]-=n,r.current[this.axis]-=n,r.requestTick())}for(let t of n)this.emit("initSlide",t,t.index)}prependSlide(t){this.addSlide(0,t)}appendSlide(t){this.addSlide(this.slides.length,t)}removeSlide(t){var e=this.slides.length,e=this.slides[t=(t%e+e)%e];if(e){this.removeSlideEl(e,!0),this.slides.splice(t,1);for(let t=0;t<this.slides.length;t++)this.slides[t].index=t;this.updateMetrics(),this.slideTo(this.page,{friction:0,transition:!1}),this.emit("destroySlide",e)}}updateMetrics(){let{panzoom:t,viewport:e,track:i,slides:o,isHorizontal:s,isInfinite:r}=this;if(i){var l,h,c,d,u=s?"width":"height";e&&(l=Math.max(e[s?"offsetWidth":"offsetHeight"],P(e.getBoundingClientRect()[u],1e3)),h=getComputedStyle(e),c="padding",d=s?"Right":"Bottom",l-=parseFloat(h[c+(s?"Left":"Top")])+parseFloat(h[c+d]),this.viewportDim=l);let n,a=0;for(let[i,s]of o.entries()){let t=0,e=0;!s.el&&n?(t=n.dim,e=n.gap):({dim:t,gap:e}=this.getSlideMetrics(s),n=s),t=P(t,1e3),e=P(e,1e3),s.dim=t,s.gap=e,s.pos=a,a+=t,(r||i<o.length-1)&&(a+=e)}a=P(a,1e3),this.contentDim=a,t&&(t.contentRect[u]=a,t.contentRect[s?"fullWidth":"fullHeight"]=a),this.pages=this.createPages(),this.pages=this.processPages(),this.state===v.Init&&this.setInitialPage(),this.page=Math.max(0,Math.min(this.page,this.pages.length-1)),this.manageSlideVisiblity(),this.emit("refresh")}}getProgress(t,e=!1,i=!1){void 0===t&&(t=this.page);var s=this.panzoom,n=this.contentDim,a=this.pages[t]||0;if(!a||!s)return t>this.page?-1:1;let o=-1*s.current.e,r=P((o-a.pos)/+a.dim,1e3),l=r,h=r;this.isInfinite&&!0!==i&&(l=P((o-a.pos+n)/+a.dim,1e3),h=P((o-a.pos-n)/+a.dim,1e3));t=[r,l,h].reduce(function(t,e){return Math.abs(e)<Math.abs(t)?e:t});return e?t:1<t?1:t<-1?-1:t}setViewportHeight(){var{page:t,pages:i,viewport:s,isHorizontal:n}=this;if(s&&i[t]){let e=0;n&&this.track&&(this.track.style.height="auto",i[t].slides.forEach(t=>{t.el&&(e=Math.max(e,t.el.offsetHeight))})),s.style.height=e?e+"px":""}}getPageForSlide(t){for(var e of this.pages)for(var i of e.slides)if(i.index===t)return e.index;return-1}getVisibleSlides(e=0){var i,n=new Set;let{panzoom:s,contentDim:a,viewportDim:o,pages:r,page:l}=this;if(o){a=a+(null==(i=this.slides[this.slides.length-1])?void 0:i.gap)||0;let t=0;t=s&&s.state!==m.Init&&s.state!==m.Destroy?-1*s.current[this.axis]:r[l]&&r[l].pos||0,this.isInfinite&&(t-=Math.floor(t/a)*a),this.isRTL&&this.isHorizontal&&(t*=-1);var h=t-o*e,c=t+o*(e+1),d=this.isInfinite?[-1,0,1]:[0];for(let s of this.slides)for(let i of d){let t=s.pos+i*a,e=t+s.dim+s.gap;t<c&&e>h&&n.add(s)}}return n}getPageFromPosition(t){var{viewportDim:e,contentDim:i,slides:s,pages:n,panzoom:a}=this,n=n.length,o=s.length,r=s[0],o=s[o-1],l=this.option("center");let h,c=0,d=void 0===t?-1*((null==a?void 0:a.target[this.axis])||0):t,u=(l&&(d+=.5*e),this.isInfinite?(d<r.pos-.5*o.gap&&(d-=i,c=-1),d>o.pos+o.dim+.5*o.gap&&(d-=i,c=1)):d=Math.max(r.pos||0,Math.min(d,o.pos)),o),g=s.find(t=>{var e=t.pos-.5*u.gap,i=t.pos+t.dim+.5*t.gap;return u=t,d>=e&&d<i});return g=g||o,{page:(h=this.getPageForSlide(g.index))+c*n,pageIndex:h}}setPageFromPosition(){var t=this.getPageFromPosition().pageIndex;this.onChange(t)}destroy(){if(![v.Destroy].includes(this.state)){this.state=v.Destroy;let{container:i,viewport:t,track:e,slides:s,panzoom:n}=this,a=this.option("classes");i.removeEventListener("click",this.onClick,{passive:!1,capture:!1}),i.removeEventListener("slideTo",this.onSlideTo),window.removeEventListener("resize",this.onResize),n&&(n.destroy(),this.panzoom=null),s&&s.forEach(t=>{this.removeSlideEl(t)}),this.detachPlugins(),t&&(t.removeEventListener("scroll",this.onScroll),t.offsetParent)&&e&&e.offsetParent&&t.replaceWith(...e.childNodes);for(let[t,e]of Object.entries(a))"container"!==t&&e&&i.classList.remove(e);this.track=null,this.viewport=null,this.page=0,this.slides=[];var o=this.events.get("ready");this.events=new Map,o&&this.events.set("ready",o)}}}Object.defineProperty(j,"Panzoom",{enumerable:!0,configurable:!0,writable:!0,value:k}),Object.defineProperty(j,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:{viewport:null,track:null,enabled:!0,slides:[],axis:"x",transition:"fade",preload:1,slidesPerPage:"auto",initialPage:0,friction:.12,Panzoom:{decelFriction:.12},center:!0,infinite:!0,fill:!0,dragFree:!1,adaptiveHeight:!1,direction:"ltr",classes:{container:"f-carousel",viewport:"f-carousel__viewport",track:"f-carousel__track",slide:"f-carousel__slide",isLTR:"is-ltr",isRTL:"is-rtl",isHorizontal:"is-horizontal",isVertical:"is-vertical",inTransition:"in-transition",isSelected:"is-selected"},l10n:{NEXT:"Next slide",PREV:"Previous slide",GOTO:"Go to slide #%d"}}}),Object.defineProperty(j,"Plugins",{enumerable:!0,configurable:!0,writable:!0,value:_}),t.Carousel=j,t.Panzoom=k});
//# sourceMappingURL=carousel.umd.min.js.map
